#! /bin/bash

# default monitor is LVDS1
MONITOR=LVDS1

# functions to switch from LVDS1 to VGA and vice versa
function ActivateVGA {
    echo "Switching to VGA1"
    xrandr --output LVDS1 --off --output HDMI2 --auto --dpi 96
    nitrogen --restore
    setxkbmap de,ru -option caps:escape -option grp:shifts_toggle
    ~/.config/polybar/launch.sh
    MONITOR=HDMI2
}
function DeactivateVGA {
    echo "Switching to LVDS1"
    xrandr --output HDMI2 --off --output LVDS1 --auto --dpi 96
    nitrogen --restore
    setxkbmap de,ru -option caps:escape -option grp:shifts_toggle
    ~/.config/polybar/launch.sh
    MONITOR=LVDS1
}

# functions to check if VGA is connected and in use
function VGAActive {
    [ $MONITOR = "HDMI2" ]
}
function VGAConnected {
    ! xrandr | grep "^HDMI2" | grep disconnected
}

# actual script
while true; do
	if ! VGAActive && VGAConnected
	then
		ActivateVGA
	fi

	if ! VGAConnected && VGAActive
	then
        	DeactivateVGA
	fi
	sleep 1s
done
